<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content=""><title>Temporal Data in D3 | Statistical Data Visualization</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/r.min.js"></script>
<script>hljs.highlightAll();</script>

  <meta name="keywords" content="">
  <meta name="description" content=""><link rel="stylesheet" href="/stat679_notes/assets/main.css?v=0.3.3" />
<script src="/stat679_notes/assets/main.js?v=0.3.3" defer></script><link rel="stylesheet" href="/stat679_notes/assets/css/tomorrow.css" />
<script src="/stat679_notes/assets/js/highlight.js"></script><script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script><script src="https://unpkg.com/mermaid@7.1.0/dist/mermaid.min.js" defer></script></head>
<body class="body-post">
    <a href="/stat679_notes/" class="logo"><h1>Statistical Data Visualization</h1>
</a><main class="post__wrapper"><div class="post__top_navs clearfix">
    <nav class="post__archive_path"><a href="" id="archiveBtn">
        <div class="post__archive_icon">
          <svg width="40" height="40">
            <circle class="circle-progress" r="18" cy="20" cx="20"  stroke-linejoin="round" stroke-linecap="round" />
          </svg>
          <span class="post__archive_icon"></span>
        </div>
        Statistical Data Visualization
      </a>
    </nav>
  </div>
  <article class="post">
    <header class="post__header">
      <h1 class="post__title">Temporal Data in D3</h1>
      <div class="post__meta">
        <time>2022-06-01 00:00</time>
      </div>
    </header>
    <div class="post__content content">
      <p><em>Static temporal data visualization in D3</em></p>

<ol>
  <li>
    <p>These notes give the D3 analogs of some of the visualizations
created in our earlier notes on temporal visualization. For a pure
static visualization, these methods are not necessary — the R
approach can give satisfactory results more easily. However, if we
ever want to customize the appearance or interactivity beyond what
is possible in the R packages discussed earlier, then these examples
can serve as a starting point.</p>
  </li>
  <li>
    <p>Let’s begin with the basic line plot. We have had a few examples
before
[<a href="https://krisrs1128.github.io/stat679_notes/2022/06/01/week4-3.html">1</a>,
<a href="https://krisrs1128.github.io/stat679_notes/2022/06/01/week6-4.html">2</a>],
but we swept important details about D3’s path generators under the
rug. Remember that in the first of those examples, we had manually
generated paths using strings like<code class="language-plaintext highlighter-rouge">M 100 100 L 200 105 L 300 115</code>.
This means to start a path at pixel coordinates (100, 100), move to
the right and down by (200, 105) pixels, and so on.</p>
  </li>
  <li>
    <p>To map data to these types of coordinates, we can use an SVG path
generator. This is a function that converts an array of javascript
objects to SVG path strings like the one above. This is accomplished
by giving <code class="language-plaintext highlighter-rouge">d3.line()</code> functions that output the <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">y</code> pixel
coordinates from objects representing individual timepoints. The <code class="language-plaintext highlighter-rouge">x</code>
and <code class="language-plaintext highlighter-rouge">y</code> functions are usually light wrappers of scales that map the
raw data into pixel coordinates.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>d3.line()
  .x([helper to get x pixel coordinate])
  .y([helper to get y pixel coordinate])
</code></pre></div>    </div>
  </li>
  <li>
    <p>For example, to regenerate the lynx plot, we first store the time
series data into an array of objects,</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>let data = [{Year: ..., Lynx: ...}, ...] 
</code></pre></div>    </div>

    <p>define a temporal scale for the x-axis,</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   d3.scaleTime()
     .domain(x_extent)
     .range([margins.left, width - margins.right]),
</code></pre></div>    </div>

    <p>and finally apply a path generator defined usign <code class="language-plaintext highlighter-rouge">d3.line()</code></p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function draw_line(data, scales) {
  path_generator = d3.line()
    .x(d =&gt; scales.x(d.Year))
    .y(d =&gt; scales.y(d.Lynx));

  d3.select("#line")
    .selectAll("path")
    .data([data]).enter()
    .append("path")
    .attr("d", path_generator);
}
</code></pre></div>    </div>

    <p>which together with some axis annotation functions creates this
figure,</p>
  </li>
</ol>

<iframe src="https://krisrs1128.github.io/stat679_code/examples/week8/week8-1/line.html">
</iframe>

<ol>
  <li>
    <p>If we want to draw a collection of paths, we can use an array of
arrays. Each element of the outer collection provides a path; each
element within the inner arrays gives one timepoint.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  [{t1, value1}, {t2, value2}, ...] // first series array
  [{t2, value2}, {t2, value2}, ...] // second series
  ...
]
</code></pre></div>    </div>
  </li>
  <li>
    <p>For example, suppose we want to create a visualization of daily
electricity demand over several months. We want each line to
correspond to a single 24 hour period, and will have a few dozen
lines.</p>
  </li>
</ol>

<iframe src="https://krisrs1128.github.io/stat679_code/examples/week8/week8-1/electricity.html">
</iframe>

<ol>
  <li>
    <p>At this point, it’s not hard to add in tooltips using mouseovers.</p>
  </li>
  <li>
    <p>Path generators are just one example of a D3 function that maps raw
data to more complex visual marks. For example, to create a stacked
time series visualization, we can use <code class="language-plaintext highlighter-rouge">d3.stackArea()</code></p>
  </li>
  <li>
    <p>Using an alternative centering, the same area generator can be used
to create a D3 streamgraph.</p>
  </li>
  <li>
    <p>Just to show how flexible D3 can be, let’s see how we can create two
other types of temporal visualizations from scratch: gantt charts
and bump charts.</p>
  </li>
  <li>
    <p>Gantt charts encode the start and end of discrete temporal events.
They are often used to organize projects. They can be generated by
appending rectangles at the right task (y) and time (x) coordinates.</p>
  </li>
  <li>
    <p>Bump charts are line plots that show how ranks evolve over time. We
can create the smooth arcing lines using <code class="language-plaintext highlighter-rouge">.curve(d3.curveBumpX)</code>.</p>
  </li>
  <li>
    <p>We can customize the color depending on whether the rank has
increased or decreased by storing the change in the data and
encoding this using each path’s stroke attribute.</p>
  </li>
  <li>
    <p>You can see a full interactive version of this visualization at this
link — we’ll be discussing this in our next lecture. Notice the use
of the voronoi mouseover, like the one used in our previous notes.
We’ll discuss some more techniques for temporal interaction in the
next set of notes.</p>
  </li>
</ol>

    </div>
  </article></main><script>hljs.initHighlightingOnLoad();</script><footer class="site-footer">
  © 2022<a href="/stat679_notes/">Statistical Data Visualization</a>. Theme<a href="https://github.com/erlzhang/jekyll-theme-persephone" target="_blank">Persephone</a>
</footer>

  </body>
</html>
